<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tic-Tac-Toe</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="/css/tic.css">
</head>

<body>
    <%- include('../navbar') %>
        <h1>Tic Tac Toe</h1>
        <br>
        <div id="game-board">
            <div data-cell-index="0" class="game-cell"></div>
            <div data-cell-index="1" class="game-cell"></div>
            <div data-cell-index="2" class="game-cell"></div>
            <div data-cell-index="3" class="game-cell"></div>
            <div data-cell-index="4" class="game-cell"></div>
            <div data-cell-index="5" class="game-cell"></div>
            <div data-cell-index="6" class="game-cell"></div>
            <div data-cell-index="7" class="game-cell"></div>
            <div data-cell-index="8" class="game-cell"></div>
        </div>
        <button id="restart-button">Restart Game</button>
        <script>
            let playerO = "O";
            let playerX = "X";
            let currPlayer = playerO;

                    
            let gameBoard = ["", "", "", "", "", "", "", "", ""];
            let gameCells;
            let winningConditions = [
                [0, 1, 2], 
                [3, 4, 5], 
                [6, 7, 8], 
                [0, 3, 6], 
                [1, 4, 7], 
                [2, 5, 8], 
                [0, 4, 8], 
                [2, 4, 6]  
            ];

            let restartGameButton;
            let gameOver = false;

            window.onload = function () {
                gameCells = document.getElementsByClassName("game-cell");
                for (let cell of gameCells) {
                    cell.addEventListener("click", placeCell);
                }
                restartGameButton = this.document.getElementById("restart-button");
                restartGameButton.addEventListener("click", restartGame);
            }

            function placeCell() {
                if (gameOver) {
                    alert('gameOver')
                    return;
                }

                const index = parseInt(this.getAttribute("data-cell-index"));
                if (gameBoard[index] !== "") {
                    return;
                }

                gameBoard[index] = currPlayer; 
                this.innerText = currPlayer; 

               
                currPlayer = (currPlayer == playerO) ? playerX : playerO;

                checkWinner();
            }

            // function checkWinner() {
            //     for (let winCondition of winningConditions) {
            //         let a = gameBoard[winCondition[0]];
            //         let b = gameBoard[winCondition[1]];
            //         let c = gameBoard[winCondition[2]];

            //         if (a == b && b == c && a != "") {
            //             //update styling for winning cells
            //             for (let i = 0; i < gameBoard.length; i++) {
            //                 if (winCondition.includes(i)) {
            //                     gameCells[i].classList.add("winning-game-cell");
            //                 }
            //             }
            //             gameOver = true;
            //             return;
            //         }
            //     }
            // }

            function checkWinner() {
                for (let winCondition of winningConditions) {
                    let a = gameBoard[winCondition[0]];
                    let b = gameBoard[winCondition[1]];
                    let c = gameBoard[winCondition[2]];

                    if (a == b && b == c && a != "") {

                        for (let index of winCondition) {
                            gameCells[index].classList.add("winning-game-cell");
                        }

                        gameOver = true;
                        alert(a + " wins!");
                        return;
                    }
                }
            }

            function restartGame() {
                gameOver = false;
                gameBoard = ["", "", "", "", "", "", "", "", ""];
                for (let cell of gameCells) {
                    cell.innerText = "";
                    cell.classList.remove("winning-game-cell");
                }
            }    
        </script>
</body>

</html>