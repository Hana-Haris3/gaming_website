<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Whack-a-titan</title>
    <link rel="stylesheet" href="/css/mole.css">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">

</head>

<body>
    <%- include('../navbar') %>
        <span>WHACK A TITAN</span>
        <h2 id="score">0</h2>
        <div id="board"></div>

        <script>
            let currentTitanTile;
            let currentLeviTile;
            let score = 0
            let gameOver = false
            window.onload = function () {
                setGame();
            }

            function setGame() {

                for (i = 0; i < 9; i++) {
                    let tile = document.createElement('div')
                    tile.id = i.toString()
                    tile.addEventListener('click', selectTile)
                    document.getElementById('board').appendChild(tile)
                }
                setInterval(setTitan, 1000)
                setInterval(setLevi, 2000)
            }

            function getRandomTile() {
                let num = Math.floor(Math.random() * 9)
                return num.toString()
            }
            function setTitan() {
                if (gameOver) {
                    return
                }

                if (currentTitanTile) {
                    currentTitanTile.innerHTML = ''
                }
                let titan = document.createElement('img')
                titan.src = "/images/attack.png"

                let num = getRandomTile()
                if (currentLeviTile && currentLeviTile.id == num) {
                    return
                }
                currentTitanTile = document.getElementById(num)
                currentTitanTile.appendChild(titan)

            }

            function setLevi() {
                if (gameOver) {
                    return
                }
                if (currentLeviTile) {
                    currentLeviTile.innerHTML = ''
                }

                let levi = document.createElement('img')
                levi.src = "/images/levi.png"

                let num = getRandomTile()
                if (currentTitanTile && currentTitanTile.id == num) {
                    return
                }
                currentLeviTile = document.getElementById(num)
                currentLeviTile.appendChild(levi)
            }
            function selectTile() {
                if (gameOver) {
                    return
                }
                if (this == currentTitanTile) {
                    score += 10
                    document.getElementById('score').innerText = score.toString()
                } else if (this == currentLeviTile) {
                    document.getElementById('score').innerText = 'GAME OVER:' + score.toString()
                    gameOver = true
                }
            }
        </script>
</body>
</html>